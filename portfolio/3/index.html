<!DOCTYPE html>
<html>
  <head>
    
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-173578745-1"></script>
    <script>
      if (window.location.host==="charx7.me" || window.location.host === "www.charx7.me") {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-173578745-1');
      }
    </script>

    
      <title>Carlos Portfolio - Smart Searches</title>
    
    <!-- Bootstrap -->
    <link rel="stylesheet" type="text/css" 
      href="/static//css/bootstrap.css">
    <link rel="stylesheet" type="text/css"
      href="/static//css/main.css">  
      <!-- Font Awsome CDN -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <link rel="stylesheet" type="text/css"
      href="/static//css/colorful.css">
    
  </head>

  <!-- Pigments for code CSS -->
  

  <body>
    <header class="site-header"></header>

    <nav class="navbar navbar-expand-md navbar-dark bg-steel fixed-top">
      <div class="container">
        <a class="navbar-brand mr-4" href="/">Carlos Huerta</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarToggle" aria-controls="navbarToggle" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarToggle">
          <div class="navbar-nav mr-auto">
            <a class="nav-item nav-link" href="/about.html">About</a>
            <a class="nav-item nav-link" href="/index.html">Blog</a>
            <a class="nav-item nav-link" href="/portfolio.html">Portfolio</a>
          </div>
          <!-- Navbar Right Side 
          <div class="navbar-nav">
            <a class="nav-item nav-link" href="/login">Login</a>
            <a class="nav-item nav-link" href="/register">Register</a>
          </div>
          -->
        </div>
      </div>
    </nav>

    <!-- Paralax Image-->
    <div class = "parallax">
      <!-- Paralax Text-->
      <div class = "container-title-text">
        <h1 id="parallax-title">Carlos Huerta - Data Science Blog</h1>
      </div>
    </div>
    
    <!-- Main content-->
    <div class="main-content">
      <div class="container">
        
  <div class="content-section">
    <div class="row">
      <div class="col-md-4">
        <img src="/static/images/search.jpg" 
          class="w3-image" alt="" style="width: 100%; max-width: 300px;">  

      </div>
      <div class="col-md-8">
        <h2>
          Smart Searches
        </h2>
        <p>From hummer to hammer e-commerce smart full-text searches ranking and beyond</p>

        <hr class="my-4">
              
        <p>Tags: python, elastic-search, kibana, GCP, airflow</p>
        <p>By Carlos Huerta on Aug 24 2020</p>
      </div>
    </div>
    

    <hr class="my-4">
    
    <div><h1>Summary</h1>
<p>We implemented and deployed to GCP services an <code>Elasticsearch</code> a full-text real-time smart search engine and <code>Kibana</code> for analytics and monitoring, reducing the back-end API server load and improving query response time and relevancy of the results. Additionally, we set-up an Apache <code>Airflow</code> workflows service in the back-end server to automate various maintenance tasks. </p>
<h1>Motivation</h1>
<blockquote>
<p>Every e-commerce has faced the challenge of <strong>query performance</strong> and <strong>relevancy</strong> of the displayed search results. What would your query output be if given a customer query like 'construction materials' if none of your products (or product categories) is exactly named like it?</p>
</blockquote>
<p><strong>Agglobal</strong> faced this same challenge as the past search results were given using a full-text search on just the name of the products, so relevant information contained in other characteristics like product descriptions and product characteristics were not taken into account when producing query outputs. Even though <strong>Agglobal</strong> initial strategy to run a full-text search with raw-SQL on via an API was sufficient, as the amount of traffic and products increased, directly smashing the DB was not such a good idea anymore. This is were Elasticsearch provided a great alternative to 'understand' customer queries better and handle increasingly complex index searches.  </p>
<h1>Challenges</h1>
<p>The main challenge we faced when implementing these features; was to keep the newly created Elasticsearch index up to date. Because <strong>product availability</strong> is an essential component when displaying search results, we needed to figure a way to <strong>continually update</strong> product availability without having to maintain a real-time mirror products database.<br />
The next challenge we faced was the design of the <strong>scoring function</strong> of our retrieved products. The main idea was to keep product name as the most significant field when searching through our data, but also take into account product descriptions, characteristics, availability, profitability and if the product was a recent addition to the catalogue.  </p>
<h1>Solutions</h1>
<p>A deployment of apache airflow provided us with the best solution when it came to workflow management as a <strong>constant update</strong> of our Elasticsearch index is now periodic and automatic.  Additionally, by implementing <strong>Airflow</strong> in the back-end, we successfully <strong>automated tasks</strong> that previously were manually handled. 
Several iterations of the most efficient query and scoring function were (and are) continuously being tested. As of right now, the best-found solution utilizes bm-25 (best-matching) similarity score using NLP on our text features using fuzziness to correct for minor spelling mistakes as a base score and then boosts each record using profitability. Then it uses exponential decay the final ranking based on the popularity ranking of our products to give a small boost to already popular products.</p>
<h1>Overview</h1>
<p><div style="text-align: center;">
  <img src="/static/images/ES-workflow.png"
      alt=""
      style="text-align: center; margin-right: 10px;
      width: 100%; max-width: 50rem;" />
  </br>
</div></p>
<h1>Results</h1>
<p>Our initial results are very promising, as queries which previously reported zero results are now effectively outputting the correct products. Some examples:</p>
<ul>
<li>
<p><strong>Query('lamparaa colgante')</strong> which tranlates into 'hangingg lamps' (misspelling intended) previously output zero results. Now outputs the following products: 'roof hanging lamps', 'industrial lamps' and some replacement parts like 'photocells'.</p>
</li>
<li>
<p><strong>Query('puntas desarmador')</strong> which is a replacement part of a screwdriver now outputs 'several screwdrivers' and 'screwdriver bits'. An important thing to notice is that the 'screwdriver bits' product was named: 'PUNTAS DES.' in which 'DES.' is an abbreviation of the product 'desarmador' that means screwdriver. </p>
</li>
</ul></div>
   
    <br>
    <!-- Needed for disqus-->
    <div id="disqus_thread"></div>
   
  </div>

        
        <!-- Footer -->
        <div class="border-top pt-3">
          <small class="text-muted">
              Made with ❤️ using flask, frozen-flask, Bootstrap
          </small>

          <div class="right-footer">
            <a href="https://github.com/charx7" style="color: black!important; text-decoration: none;">
              <i class="fa fa-github" style="padding-right: 16px"></i>
            </a>
    
            <a href="https://www.linkedin.com/in/carlos-rodolfo-huerta-santiago-2b5609100/" style="color: black!important; text-decoration: none">
              <i class="fa fa-linkedin" style="padding-right: 16px"></i>
            </a>
          </div>
          
        </div>
      </div>
    </div>
    
    <!-- jQuery -->
    <script
			  src="https://code.jquery.com/jquery-3.5.1.min.js"
			  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous"></script>
    <!--  BS js -->
    <script type="text/javascript"
      src="/static/js/bootstrap.bundle.js"></script>

    

<script>
  var disqus_config = function () {
  this.page.url = 'https://charx7.me/portfolio/3/';  // Your page's canonical URL variable
  this.page.identifier = 'p_id_3'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
  };
  (function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = 'https://carlos-huerta-blog.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                          


  </body>
</html>